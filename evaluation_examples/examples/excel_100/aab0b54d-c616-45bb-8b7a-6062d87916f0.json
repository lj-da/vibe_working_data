{
  "id": "aab0b54d-c616-45bb-8b7a-6062d87916f0",
  "snapshot": "libreoffice_calc",
  "instruction": "在空白单元格填写收付金额，根据收付金额自动获取两种序号。得到黄色部分的收或付的编号",
  "method": "使用IF和COUNTA函数组合的公式来自动生成收付款编号。在E2单元格中输入公式=IF(C2=\"\",\"付\"&COUNTA($D$2:D2),\"收\"&COUNTA($C$2:C2))，然后复制公式到其他行。第一步：IF函数检查C2单元格（收款金额列）是否为空。第二步：如果C2为空，说明这是一笔付款，执行第一个分支：\"付\"&COUNTA($D$2:D2)。COUNTA($D$2:D2)统计从D2到当前行的D列中非空单元格的数量，即付款的序号，然后与\"付\"字拼接，生成\"付1\"、\"付2\"等编号。第三步：如果C2不为空，说明这是一笔收款，执行第二个分支：\"收\"&COUNTA($C$2:C2)。COUNTA($C$2:C2)统计从C2到当前行的C列中非空单元格的数量，即收款的序号，然后与\"收\"字拼接，生成\"收1\"、\"收2\"等编号。第四步：公式向下复制时，相对引用会自动调整（C2变为C3、C4等，D2变为D3、D4等），而绝对引用$C$2和$D$2保持不变，确保始终从第2行开始统计。这样，每笔收款会自动生成递增的收款编号（收1、收2...），每笔付款会自动生成递增的付款编号（付1、付2...），两种编号独立计数。",
  "source": "original",
  "config": [
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/140.xlsx",
            "path": "/home/user/payment_receipt_numbering.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/payment_receipt_numbering.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/aab0b54d-c616-45bb-8b7a-6062d87916f0",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "payment_receipt_numbering.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_if_counta_payment_receipt_numbering",
    "result": {
      "type": "vm_file",
      "path": "/home/user/payment_receipt_numbering.xlsx",
      "dest": "payment_receipt_numbering.xlsx"
    },
    "options": {
      "check_column": "E",
      "start_row": 2,
      "receipt_column": "C",
      "payment_column": "D",
      "expected_functions": [
        "IF",
        "COUNTA"
      ],
      "receipt_prefix": "收",
      "payment_prefix": "付",
      "data_column": "E"
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/aab0b54d-c616-45bb-8b7a-6062d87916f0/payment_receipt_numbering_gt.xlsx",
      "dest": "payment_receipt_numbering_gt.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}