{
  "id": "0d371097-8ca8-4f3c-b656-a91608066159",
  "snapshot": "libreoffice_calc",
  "instruction": "如何设置销量增长率",
  "method": "使用TEXT函数结合IF函数来格式化销量增长率，正数显示向上箭头，负数显示向下箭头。在目标单元格（如M14）中输入公式=TEXT(L14/K14-1,IF((L14/K14)-1>0,\"0%↑\",\"0%↓\"))。该公式的工作原理：1) L14/K14-1计算增长率，即(当前年销量-基年销量)/基年销量，得到小数形式的增长率（如1.0表示100%增长，-0.5表示-50%下降）；2) IF((L14/K14)-1>0,\"0%↑\",\"0%↓\")判断增长率是否大于0，如果大于0返回格式字符串\"0%↑\"（正数百分比加向上箭头），否则返回格式字符串\"0%↓\"（负数百分比加向下箭头）；3) TEXT函数将增长率数值按照IF函数返回的格式字符串进行格式化，将小数转换为百分比并添加相应的箭头符号；4) 例如，如果K14=1（2023年销量），L14=2（2024年销量），则L14/K14-1=1.0（100%增长），IF返回\"0%↑\"，TEXT格式化后显示为\"100%↑\"；5) 将公式复制到M列的其他行（如M15、M16等），相对引用会自动调整（L14/K14变为L15/K15、L16/K16等），确保每行都能计算对应行的销量增长率。这样就能以直观的方式显示销量的增长或下降趋势。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nM14=TEXT(L14/K14-1,IF((L14/K14)-1>0,\"0%↑\",\"0%↓\"))\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/13.xlsx",
            "path": "/home/user/Desktop/sales_growth_rate.xlsx"
          }
        ]
      }
    }
  ],
  "trajectory": "trajectories/0d371097-8ca8-4f3c-b656-a91608066159",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "sales_growth_rate.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_text_if_growth_rate",
    "result": {
      "type": "vm_file",
      "path": "/home/user/Desktop/sales_growth_rate.xlsx",
      "dest": "sales_growth_rate.xlsx"
    },
    "options": {
      "check_column": "M",
      "base_column": "K",
      "current_column": "L",
      "start_row": 14,
      "data_column": "J"
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/0d371097-8ca8-4f3c-b656-a91608066159/sales_growth_rate_gt.xlsx",
      "dest": "sales_growth_rate_gt.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}