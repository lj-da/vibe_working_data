{
  "id": "184c108a-7d27-491f-a6a9-ff72e36e60b0",
  "snapshot": "libreoffice_calc",
  "instruction": "通过某种函数自动求出部件1、部件2、部件3、部件4、部件5的出货年月？",
  "method": "使用IFERROR、TEXT、VLOOKUP、INDEX、SMALL、IF、COUNTIF和ROW函数组合来实现跨表查找和日期格式化。第一步：在B2单元格中输入公式=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$A$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")。公式的工作原理：COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$A$2&\"*\")在整机SN关联表的C3:G31范围内查找包含A2值的单元格，使用通配符\"*\"进行模糊匹配；IF(COUNTIF(...)>0,ROW($1:$29),1E+099)判断是否找到匹配，如果找到则返回对应的行号（ROW($1:$29)），否则返回一个很大的数（1E+099）；SMALL(...,ROW(A1))从所有行号中提取第n小的值（第1个、第2个匹配等）；INDEX(整机SN关联表.$B$3:$B$31,...)根据行号从整机SN关联表的B3:B31中提取对应的整机SN；VLOOKUP(...,整机出货年月.$B$2:$C$30,2,0)在整机出货年月表的B2:C30范围内查找整机SN，返回第2列（日期列）的值；TEXT(...,\"YYYY-MM-DD\")将日期格式化为YYYY-MM-DD格式；IFERROR(...,\"\")处理错误情况，如果查找失败则返回空字符串。第二步：在D2单元格中输入类似的公式，但将$A$2改为$C$2，用于查找部件2的出货年月。第三步：依次在F2、H2、J2单元格中输入公式，分别将引用改为$E$2、$G$2、$I$2，用于查找部件3、部件4、部件5的出货年月。第四步：将B2、D2、F2、H2、J2的公式向下复制到其他行，相对引用会自动调整。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nB2=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$A$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")\nD2=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$C$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")\nF2=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$E$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")\nH2=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$G$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")\nJ2=IFERROR(TEXT(VLOOKUP(INDEX(整机SN关联表.$B$3:$B$31,SMALL(IF(COUNTIF(整机SN关联表.$C$3:$G$31,\"*\"&$I$2&\"*\")>0,ROW($1:$29),1E+099),ROW(A1))),整机出货年月.$B$2:$C$30,2,0),\"YYYY-MM-DD\"),\"\")\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/253.xlsx",
            "path": "/home/user/iferror_text_vlookup_index_small_countif.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/iferror_text_vlookup_index_small_countif.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/184c108a-7d27-491f-a6a9-ff72e36e60b0",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "iferror_text_vlookup_index_small_countif.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_iferror_text_vlookup_index_small_countif",
    "result": {
      "type": "vm_file",
      "path": "/home/user/iferror_text_vlookup_index_small_countif.xlsx",
      "dest": "iferror_text_vlookup_index_small_countif.xlsx"
    },
    "options": {
      "check_columns": ["B", "D", "F", "H", "J"],
      "start_row": 2,
      "source_columns": ["A", "C", "E", "G", "I"],
      "expected_functions": ["IFERROR", "TEXT", "VLOOKUP", "INDEX", "SMALL", "IF", "COUNTIF", "ROW"],
      "data_column": "A",
      "sn_table": "整机SN关联表",
      "date_table": "整机出货年月",
      "sn_range": "$B$3:$B$31",
      "search_range": "$C$3:$G$31",
      "lookup_range": "$B$2:$C$30",
      "date_format": "YYYY-MM-DD"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}

