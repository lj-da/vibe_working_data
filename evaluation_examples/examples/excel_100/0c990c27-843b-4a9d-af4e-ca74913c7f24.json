{
  "id": "0c990c27-843b-4a9d-af4e-ca74913c7f24",
  "snapshot": "libreoffice_calc",
  "instruction": "求所有相同数据之间行号的间隔值",
  "method": "第一步：在B列输入公式=IF(COUNTIF($A$4:A4,A4)>1,ROW()-LOOKUP(2,1/($A3:A$4=A4),ROW($A3:A$4))-1,0)，用于计算重复值的行号差。公式的工作原理：COUNTIF($A$4:A4,A4)统计从A4到当前行的A列中，与当前行A列值相同的单元格数量；如果大于1，说明有重复；LOOKUP(2,1/($A3:A$4=A4),ROW($A3:A$4))找到上一个相同值所在的行号；ROW()-LOOKUP(...)-1计算当前行与上一个相同行的差值。第二步：在D列输入公式=UNIQUE(A4:A3278)，从A列中提取所有唯一值。公式的工作原理：UNIQUE(A4:A3278)会扫描A4到A3278的所有单元格，返回一个包含唯一值的数组，去除重复的值。第三步：在E列输入公式=TEXTJOIN(\";\",1,IF($A$4:$A$3278=D4,$B$4:$B$3278,\"\")），将匹配D4的A列值对应的B列值用分号连接。公式的工作原理：IF($A$4:$A$3278=D4,$B$4:$B$3278,\"\")检查A列中哪些值等于D4，返回对应的B列值，否则返回空字符串；TEXTJOIN(\";\",1,...)将这些值用分号连接成一个字符串。第四步：在F列输入公式=FILTER(--TEXTSPLIT(E4,\";\"),--TEXTSPLIT(E4,\";\")>0)，从E列的文本中提取大于0的数值。公式的工作原理：TEXTSPLIT(E4,\";\")将E4单元格中的文本按分号分割成数组；--TEXTSPLIT(...)将文本转换为数值；FILTER(...,...>0)过滤出大于0的数值。注意：D、E、F列的公式输入后需要按CTRL+SHIFT+ENTER（数组公式）才能正确计算。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nB4=IF(COUNTIF($A$4:A4,A4)>1,ROW()-LOOKUP(2,1/($A3:A$4=A4),ROW($A3:A$4))-1,0)\nD4=UNIQUE(A4:A3278)\nE4=TEXTJOIN(\";\",1,IF($A$4:$A$3278=D4,$B$4:$B$3278,\"\"))\nF4=FILTER(--TEXTSPLIT(E4,\";\"),--TEXTSPLIT(E4,\";\")>0)\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/269.xlsx",
            "path": "/home/user/multi_formula_data.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/multi_formula_data.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/0c990c27-843b-4a9d-af4e-ca74913c7f24",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "multi_formula_data.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_multi_column_formulas",
    "result": {
      "type": "vm_file",
      "path": "/home/user/multi_formula_data.xlsx",
      "dest": "multi_formula_data.xlsx"
    },
    "options": {
      "formula_columns": ["B", "D", "E", "F"],
      "expected_functions": ["IF", "COUNTIF", "LOOKUP", "ROW", "UNIQUE", "TEXTJOIN", "FILTER", "TEXTSPLIT"]
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/0c990c27-843b-4a9d-af4e-ca74913c7f24/multi_formula_data.xlsx",
      "dest": "multi_formula_data.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}

