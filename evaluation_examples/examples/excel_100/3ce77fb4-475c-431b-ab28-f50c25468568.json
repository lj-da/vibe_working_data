{
  "id": "3ce77fb4-475c-431b-ab28-f50c25468568",
  "snapshot": "libreoffice_calc",
  "instruction": "用公式在\"本周销售\"sheet的D列调用\"上周销售\"的对应的数据，用来对比",
  "method": "使用SUMPRODUCT函数在\"本周销售\"sheet的D列中查找\"上周销售\"sheet的对应数据。第一步：在\"本周销售\"sheet的D2单元格中输入公式=SUMPRODUCT((上周销售.$A$2:$A$19=A2)*(上周销售.$B$2:$B$19=B2),上周销售.$C$2:$C$19)，然后复制公式到D列的其他行。SUMPRODUCT函数的工作原理：第一个条件(上周销售.$A$2:$A$19=A2)检查\"上周销售\"sheet的A列（城市）中是否有与当前行A列（城市）相同的值，返回一个布尔数组。第二个条件(上周销售.$B$2:$B$19=B2)检查\"上周销售\"sheet的B列（货号）中是否有与当前行B列（货号）相同的值，返回另一个布尔数组。两个条件相乘(*)得到同时满足两个条件的行（即城市和货号都匹配的行）。最后，SUMPRODUCT将匹配行的\"上周销售\"sheet的C列（销售数量）值相加并返回。由于每个城市和货号的组合应该是唯一的，SUMPRODUCT实际上会返回匹配行的C列值。这样，D列就显示了\"上周销售\"sheet中对应城市和货号的销售数量，用于与\"本周销售\"sheet的C列数据进行对比。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "echo '=SUMPRODUCT((上周销售.$A$2:$A$19=A2)*(上周销售.$B$2:$B$19=B2),上周销售.$C$2:$C$19)' > /home/user/Desktop/formula.txt"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/184.xlsx",
            "path": "/home/user/cross_sheet_lookup.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/cross_sheet_lookup.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/3ce77fb4-475c-431b-ab28-f50c25468568",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "cross_sheet_lookup.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_sumproduct_cross_sheet_lookup",
    "result": {
      "type": "vm_file",
      "path": "/home/user/cross_sheet_lookup.xlsx",
      "dest": "cross_sheet_lookup.xlsx"
    },
    "options": {
      "target_sheet": "本周销售",
      "source_sheet": "上周销售",
      "target_column": "D",
      "source_column_a": "A",
      "source_column_b": "B",
      "source_column_c": "C",
      "target_column_a": "A",
      "target_column_b": "B",
      "start_row": 2,
      "data_range_start": 2,
      "data_range_end": 19,
      "data_column": "A"
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/3ce77fb4-475c-431b-ab28-f50c25468568/cross_sheet_lookup.xlsx",
      "dest": "cross_sheet_lookup.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}