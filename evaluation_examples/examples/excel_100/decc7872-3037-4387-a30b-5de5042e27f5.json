{
  "id": "decc7872-3037-4387-a30b-5de5042e27f5",
  "snapshot": "libreoffice_calc",
  "instruction": "统计6月份甲方签订了多少个合同，合同金额合计为多少，请问该怎么统计？",
  "method": "使用SUMPRODUCT函数结合MONTH函数来统计6月份甲方的合同数量和金额。第一步：在B28单元格中输入公式=SUMPRODUCT(--(MONTH($A$2:$A$24)=6),--($B$2:$B$24=A28))，这个公式统计6月份甲方的合同个数。SUMPRODUCT函数的工作原理：第一个条件--(MONTH($A$2:$A$24)=6)检查$A$2:$A$24范围内的日期是否属于6月份，MONTH函数提取日期的月份，=6判断是否为6月，--（双负号）将TRUE/FALSE转换为1/0。使用绝对引用$A$2:$A$24确保范围固定不变。第二个条件--($B$2:$B$24=A28)检查$B$2:$B$24范围内的客户名称是否等于A28（甲方），同样使用--转换为1/0。使用绝对引用$B$2:$B$24确保范围固定，而A28使用相对引用以便复制公式时自动调整。SUMPRODUCT将两个条件数组相乘后求和，只有同时满足两个条件的行才会被计数（1×1=1），其他情况为0。第二步：在C28单元格中输入公式=SUMPRODUCT(--(MONTH($A$2:$A$24)=6),--($B$2:$B$24=A28),$C$2:$C$24)，这个公式统计6月份甲方的合同金额合计。与B28公式的区别是增加了第三个参数$C$2:$C$24（金额列，使用绝对引用），SUMPRODUCT会将满足条件的行的金额相加。这样，B28显示合同个数，C28显示合同金额合计。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nB28=SUMPRODUCT(--(MONTH($A$2:$A$24)=6),--($B$2:$B$24=A28))\nC28=SUMPRODUCT(--(MONTH($A$2:$A$24)=6),--($B$2:$B$24=A28),$C$2:$C$24)\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/219.xlsx",
            "path": "/home/user/sumproduct_month_customer.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/sumproduct_month_customer.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/decc7872-3037-4387-a30b-5de5042e27f5",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "sumproduct_month_customer.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_sumproduct_month_customer_count",
    "result": {
      "type": "vm_file",
      "path": "/home/user/sumproduct_month_customer.xlsx",
      "dest": "sumproduct_month_customer.xlsx"
    },
    "options": {
      "formulas": {
        "B28": {
          "type": "count",
          "date_range": "$A$2:$A$24",
          "customer_range": "$B$2:$B$24",
          "customer_cell": "A28",
          "month": 6
        },
        "C28": {
          "type": "sum",
          "date_range": "$A$2:$A$24",
          "customer_range": "$B$2:$B$24",
          "customer_cell": "A28",
          "amount_range": "$C$2:$C$24",
          "month": 6
        }
      }
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/decc7872-3037-4387-a30b-5de5042e27f5/sumproduct_month_customer.xlsx",
      "dest": "sumproduct_month_customer.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}