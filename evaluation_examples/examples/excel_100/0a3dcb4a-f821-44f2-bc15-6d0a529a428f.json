{
  "id": "0a3dcb4a-f821-44f2-bc15-6d0a529a428f",
  "snapshot": "libreoffice_calc",
  "instruction": "如何筛选只留下前10%和后10%的数据",
  "method": "使用MATCH和PERCENTILE函数来筛选前10%和后10%的数据。在B1单元格中输入公式=MATCH(A1,PERCENTILE(A:A,{0,10,90}%))，然后复制公式到D列的其他行。第一步：PERCENTILE(A:A,{0,10,90}%)计算A列的第0、10和90百分位数，返回一个包含三个值的数组。第0百分位数是最小值，第10百分位数是前10%的阈值，第90百分位数是后10%的阈值。第二步：MATCH(A1,PERCENTILE(...))在PERCENTILE返回的数组中查找A1的值，返回匹配的位置。如果A1的值小于等于第10百分位数，MATCH返回1；如果A1的值大于第10百分位数但小于等于第90百分位数，MATCH返回2；如果A1的值大于第90百分位数，MATCH返回3。第三步：公式向下复制时，相对引用会自动调整（A1变为A2、A3等），确保每行都检查对应行的A列数据。这样，D列的值可以用来筛选数据：值为1表示数据在前10%（最小值到第10百分位数），值为3表示数据在后10%（第90百分位数到最大值），值为2表示数据在中间80%范围内。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "echo '=MATCH(A1,PERCENTILE(A:A,{0,10,90}%))' > /home/user/Desktop/formula.txt"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/216.xlsx",
            "path": "/home/user/match_percentile_filter.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/match_percentile_filter.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/0a3dcb4a-f821-44f2-bc15-6d0a529a428f",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "match_percentile_filter.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_match_percentile_filter",
    "result": {
      "type": "vm_file",
      "path": "/home/user/match_percentile_filter.xlsx",
      "dest": "match_percentile_filter.xlsx"
    },
    "options": {
      "result_column": "B",
      "source_column": "A",
      "start_row": 1,
      "expected_functions": ["MATCH", "PERCENTILE"],
      "expected_percentiles": "{0,10,90}%",
      "data_column": "A"
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/0a3dcb4a-f821-44f2-bc15-6d0a529a428f/match_percentile_filter.xlsx",
      "dest": "match_percentile_filter.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}

