{
  "id": "a496c5e1-30b7-4a5e-92e2-b5b2b2a008f4",
  "snapshot": "libreoffice_calc",
  "instruction": "按在班人数来排座位号，比如说1班有47人，座位号就0101-0147，2班48人，座位号0201-0248（考场号01表示在01班考，安排到这个考场的人数就是01班的实际人数，按照顺序从上到下，01考场安排完，安排02考场）。",
  "method": "使用TEXT、OFFSET、SMALL、IF、COLUMN、ROW和COUNTIF函数来按班级人数排列座位号。具体步骤：1) 在D2单元格中输入公式=TEXT(OFFSET(J$2,SMALL(IF(COLUMN(A:CZ)<=K$3:K$11,J$3:J$11,99),ROW(A1)),),\"00\")，该公式使用COLUMN(A:CZ)生成列号数组，IF函数根据K$3:K$11中的班级人数条件筛选J$3:J$11中的班级编号，SMALL函数获取第n小的值（n由ROW(A1)决定，随公式向下复制递增），OFFSET从J$2开始偏移获取班级编号，TEXT格式化为两位数字；2) 将D2的公式填充到D2:D427区域；3) 在E2单元格中输入公式=D2&TEXT(COUNTIF(D$2:D2,D2),\"00\")，该公式使用COUNTIF统计当前D列值从D$2到当前行的出现次数，TEXT格式化为两位数字，然后与D2的值连接形成完整座位号；4) 将E2的公式填充到E2:E427区域；5) 所有指定单元格（D2:D427和E2:E427）都需要验证，确保公式正确。",
  "source": "original",
  "config": [
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/286.xlsx",
            "path": "/home/user/seat_number_data.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/seat_number_data.xlsx"
      }
    },
    {
      "type": "execute",
      "parameters": {
        "command": [
          "python",
          "-c",
          "import os; desktop = os.path.join(os.path.expanduser('~'), 'Desktop'); os.makedirs(desktop, exist_ok=True); f = open(os.path.join(desktop, 'seat_number_formula.txt'), 'w', encoding='utf-8'); f.write('=TEXT(OFFSET(J$2,SMALL(IF(COLUMN(A:CZ)<=K$3:K$11,J$3:J$11,99),ROW(A1)),),\"00\")\\n=D2&TEXT(COUNTIF(D$2:D2,D2),\"00\")'); f.close()"
        ]
      }
    }
  ],
  "trajectory": "trajectories/a496c5e1-30b7-4a5e-92e2-b5b2b2a008f4",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "seat_number_data.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_seat_number_arrangement",
    "result": {
      "type": "vm_file",
      "path": "/home/user/seat_number_data.xlsx",
      "dest": "seat_number_data.xlsx"
    },
    "options": {
      "d_range": "D2:D427",
      "e_range": "E2:E427",
      "expected_functions_d": ["TEXT", "OFFSET", "SMALL", "IF", "COLUMN", "ROW"],
      "expected_functions_e": ["TEXT", "COUNTIF"]
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}

