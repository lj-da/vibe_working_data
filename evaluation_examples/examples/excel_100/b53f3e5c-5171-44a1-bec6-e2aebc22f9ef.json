{
  "id": "b53f3e5c-5171-44a1-bec6-e2aebc22f9ef",
  "snapshot": "libreoffice_calc",
  "instruction": "如何根据A列到D列中的数据，在G列到AS列中分类汇总，即求各班级各个码数的校服总数是多少",
  "method": "使用SUMPRODUCT函数结合MID函数来分类汇总各班级各个码数的校服总数。第一步：在G7单元格中输入公式=SUMPRODUCT((($A$6:$A$313)=--MID(G$6,1,3))*(($C$6:$C$313)=$F7),$D$6:$D$313)。该公式的工作原理：第一个条件($A$6:$A$313)=--MID(G$6,1,3)检查A列中的班级号是否等于从G$6单元格中提取的前3个字符（班级号）。MID(G$6,1,3)从G$6单元格中提取从第1个字符开始的3个字符（如\"101班\"提取为\"101\"），--（双负号）将文本转换为数字，然后与A列的班级号进行比较。使用绝对引用$A$6:$A$313确保数据范围固定。第二个条件($C$6:$C$313)=$F7检查C列中的码数是否等于F7单元格的值（码数）。使用绝对引用$C$6:$C$313确保数据范围固定，$F7使用混合引用（列绝对行相对）以便复制公式时行号自动调整。SUMPRODUCT将两个条件数组相乘后，对满足条件的D列数值求和。公式可以向右复制到AS列（列号会变化，G$6会变成H$6、I$6等），向下复制到第19行（行号会变化，$F7会变成$F8、$F9等）。第二步：在G20单元格中输入公式=SUM(G7:G19)，对G7到G19单元格求和，得到该班级所有码数的校服总数。然后将G20的公式向右复制到AS20，得到各班级的校服总数。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nG7=SUMPRODUCT((($A$6:$A$313)=--MID(G$6,1,3))*(($C$6:$C$313)=$F7),$D$6:$D$313)\nG20=SUM(G7:G19)\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_100/279.xlsx",
            "path": "/home/user/sumproduct_mid_class_size_sum.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/sumproduct_mid_class_size_sum.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/b53f3e5c-5171-44a1-bec6-e2aebc22f9ef",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "sumproduct_mid_class_size_sum.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_sumproduct_mid_class_size_sum",
    "result": {
      "type": "vm_file",
      "path": "/home/user/sumproduct_mid_class_size_sum.xlsx",
      "dest": "sumproduct_mid_class_size_sum.xlsx"
    },
    "options": {
      "formula_range": "G7:AS19",
      "sum_range": "G20:AS20",
      "expected_functions": ["SUMPRODUCT", "MID"],
      "class_range": "$A$6:$A$313",
      "size_range": "$C$6:$C$313",
      "quantity_range": "$D$6:$D$313",
      "header_row": 6,
      "size_column": "F",
      "start_row": 7,
      "end_row": 19
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}

