{
  "id": "7ec37ed5-ee81-4491-8925-49606d2edd8a",
  "snapshot": "libreoffice_calc",
  "instruction": "求大神怎么做出簇状柱形图,需求\n1.统一主次坐标轴；\n2:分别对三个系列数据分明\n3:增降浮用虚线表明，更直观看数据变化；\n4.左测增加年度总业绩。\n5.并用饼状图阐述，年度同比增长情况；",
  "method": "首先打开Excel文件，查看数据表格。在E列创建辅助列：在E2单元格输入公式=MAX(B2:C2)*1.2，然后向下填充到E13。选中包含所有数据的区域（A1:E13），点击菜单栏的\"插入\"选项，选择\"图表\"，创建柱状图。创建图表后，需要添加三个系列：2022年、2023年、系列3。在图表上右键点击选择\"选择数据\"，添加系列\"2022年\"，设置值为B2:B13，水平轴标签为A2:A13。然后添加系列\"2023年\"，设置值为C2:C13，水平轴标签为A2:A13。接着添加系列\"系列3\"，设置值为E2:E13，水平轴标签为A2:A13。接下来设置坐标轴：选中\"2022年\"和\"2023年\"系列，右键点击选择\"设置数据系列格式\"，在系列选项中将其设置到次坐标轴（次Y轴）。然后设置次坐标轴的最大值：右键点击次坐标轴，选择\"设置坐标轴格式\"，将最大值设置为300。设置分类间距：选中\"2022年\"和\"2023年\"系列，分别设置分类间距为150%。选中\"系列3\"系列，设置分类间距为150%。设置系列3的填充和线条样式：选中\"系列3\"系列，右键点击选择\"设置数据系列格式\"，在填充选项中设置为\"无填充\"，在线条选项中设置线条样式为系统点线，线条宽度为1磅，线条类型为单线。为\"系列3\"系列添加数据标签：右键点击\"系列3\"系列，选择\"添加数据标签\"，然后右键点击数据标签，选择\"设置数据标签格式\"，勾选\"单元格中的值\"，选择D2:D13作为标签来源。",
  "source": "original",
  "config": [
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_visualization/346.xlsx",
            "path": "/home/user/Desktop/nested_chart_with_helper_column.xlsx"
          }
        ]
      }
    }
  ],
  "trajectory": "trajectories/7ec37ed5-ee81-4491-8925-49606d2edd8a",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "nested_chart_with_helper_column.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_nested_chart_with_helper_column",
    "result": {
      "type": "vm_file",
      "path": "/home/user/Desktop/nested_chart_with_helper_column.xlsx",
      "dest": "nested_chart_with_helper_column.xlsx"
    },
    "options": {
      "sheet_idx": 0,
      "helper_column_range": "E2:E13",
      "helper_column_formula": "MAX(B2:C2)*1.2",
      "series_config": {
        "2022年": {
          "value_range": "B2:B13",
          "gap_width": 150,
          "use_secondary_axis": true,
          "has_data_labels": false
        },
        "2023年": {
          "value_range": "C2:C13",
          "gap_width": 150,
          "use_secondary_axis": true,
          "has_data_labels": false
        },
        "series3": {
          "value_range": "E2:E13",
          "gap_width": 150,
          "use_secondary_axis": false,
          "has_data_labels": true,
          "data_label_range": "D2:D13",
          "no_fill": true,
          "line_style": {
            "dotted": true,
            "width_pt": 1,
            "single_line": true
          }
        }
      },
      "secondary_axis_max": 300
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}
