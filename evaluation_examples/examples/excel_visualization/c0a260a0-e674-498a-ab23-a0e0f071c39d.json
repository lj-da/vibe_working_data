{
  "id": "c0a260a0-e674-498a-ab23-a0e0f071c39d",
  "snapshot": "libreoffice_calc",
  "instruction": "求助大神，帮忙做一份月度目月度达成率分析柱状组合图；要求：1.图表达成及达成率分层展示,达成率区分完成及未完成2.用不同颜色标记散点修饰刻画,分别添加月度达成均值及达成率均值度分析月度数据及达成趋势",
  "method": "首先在E2单元格输入公式：=IF(D2>=1,D2,NA())，在F2单元格输入公式：=IF(D2<1,D2,NA())，在G2单元格输入公式：=AVERAGE($C$2:$C$13)，在H2单元格输入公式：=AVERAGE($D$2:$D$13)，然后将E2:H2的公式填充到E2:H13单元格区域。接下来，选中数据区域（包括A1:H13），点击菜单栏的\"插入\"选项，选择\"图表\"，在图表类型中选择\"组合图\"或\"柱状图\"。创建图表后，右键点击图表，选择\"选择数据\"，添加以下7个数据系列：第一个系列名称为\"目标\"，数据范围为B2:B13，图表类型为柱状图，绘制在主坐标轴；第二个系列名称为\"达成\"，数据范围为C2:C13，图表类型为柱状图，绘制在主坐标轴；第三个系列名称为\"达成率\"，数据范围为D2:D13，图表类型为折线图，绘制在次坐标轴；第四个系列名称为\"完成\"，数据范围为E2:E13，图表类型为散点图，绘制在次坐标轴；第五个系列名称为\"未完成\"，数据范围为F2:F13，图表类型为散点图，绘制在次坐标轴；第六个系列名称为\"达成月均值\"，数据范围为G2:G13，图表类型为折线图，绘制在主坐标轴；第七个系列名称为\"达成率均值\"，数据范围为H2:H13，图表类型为柱状图，绘制在次坐标轴。然后，右键点击次坐标轴，选择\"坐标轴格式\"，设置最小值为-2；右键点击主坐标轴，选择\"坐标轴格式\"，设置最大值为800。完成所有设置后，保存文件。",
  "source": "original",
  "config": [
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_visualization/326.xlsx",
            "path": "/home/user/Desktop/monthly_achievement_chart.xlsx"
          }
        ]
      }
    },
    {
      "type": "execute",
      "parameters": {
        "command": [
          "python",
          "-c",
          "import os; desktop = os.path.join(os.path.expanduser('~'), 'Desktop'); os.makedirs(desktop, exist_ok=True); f = open(os.path.join(desktop, 'formula.txt'), 'w', encoding='utf-8'); f.write('E2: =IF(D2>=1,D2,NA())\\nF2: =IF(D2<1,D2,NA())\\nG2: =AVERAGE($C$2:$C$13)\\nH2: =AVERAGE($D$2:$D$13)\\n\\n说明：将E2:H2的公式填充到E2:H13区域'); f.close()"
        ]
      }
    }
  ],
  "trajectory": "trajectories/c0a260a0-e674-498a-ab23-a0e0f071c39d",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "monthly_achievement_chart.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_monthly_achievement_combo_chart",
    "result": {
      "type": "vm_file",
      "path": "/home/user/Desktop/monthly_achievement_chart.xlsx",
      "dest": "monthly_achievement_chart.xlsx"
    },
    "options": {
      "formula_range": "E2:H13",
      "expected_formulas": {
        "E2": "=IF(D2>=1,D2,NA())",
        "F2": "=IF(D2<1,D2,NA())",
        "G2": "=AVERAGE($C$2:$C$13)",
        "H2": "=AVERAGE($D$2:$D$13)"
      },
      "series_config": [
        {
          "name": "目标",
          "data_range": "B2:B13",
          "chart_type": "barChart",
          "axis": "primary"
        },
        {
          "name": "达成",
          "data_range": "C2:C13",
          "chart_type": "barChart",
          "axis": "primary"
        },
        {
          "name": "达成率",
          "data_range": "D2:D13",
          "chart_type": "lineChart",
          "axis": "secondary"
        },
        {
          "name": "完成",
          "data_range": "E2:E13",
          "chart_type": "scatterChart",
          "axis": "secondary"
        },
        {
          "name": "未完成",
          "data_range": "F2:F13",
          "chart_type": "scatterChart",
          "axis": "secondary"
        },
        {
          "name": "达成月均值",
          "data_range": "G2:G13",
          "chart_type": "lineChart",
          "axis": "primary"
        },
        {
          "name": "达成率均值",
          "data_range": "H2:H13",
          "chart_type": "lineChart",
          "axis": "secondary"
        }
      ],
      "primary_axis_max": 800,
      "secondary_axis_min": -2
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/c0a260a0-e674-498a-ab23-a0e0f071c39d/monthly_achievement_chart.xlsx",
      "dest": "monthly_achievement_chart.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}
