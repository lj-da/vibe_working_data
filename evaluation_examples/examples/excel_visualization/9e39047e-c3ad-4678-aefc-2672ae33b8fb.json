{
  "id": "9e39047e-c3ad-4678-aefc-2672ae33b8fb",
  "snapshot": "libreoffice_calc",
  "instruction": "1、这是一个中文比较大小，最终高亮显示的问题。2、假设四个老人。老赵，老钱，老孙，老李。3、假设四人的年纪大小排列为：老赵>老钱>老孙>老李。4、请问，如何在EXL中实现：如果B1>A1（或者B1-A1>0），那么B1用加粗红色显示？",
  "method": "使用条件格式功能，在A2:B2范围内设置条件格式规则。条件公式为：FIND(A1,\"老赵，老钱，老孙，老李\")>FIND(A2,\"老赵，老钱，老孙，老李\")。FIND函数用于在字符串\"老赵，老钱，老孙，老李\"中查找单元格的值，返回该值在字符串中的位置。如果B1的值在字符串中的位置大于A1的值在字符串中的位置，说明B1的年纪小于A1（因为年纪越大，在字符串中位置越靠前），此时条件为真，应用红色字体格式。由于条件公式使用相对引用，当应用到不同单元格时，公式会自动调整：A2单元格的公式为FIND(A1,\"老赵，老钱，老孙，老李\")>FIND(A2,\"老赵，老钱，老孙，老李\")，B2单元格的公式为FIND(A1,\"老赵，老钱，老孙，老李\")>FIND(B2,\"老赵，老钱，老孙，老李\")。这样就能根据中文文本在固定字符串中的位置来判断大小关系，并高亮显示符合条件的单元格。",
  "source": "original",
  "config": [
    {
      "type": "execute",
      "parameters": {
        "command": [
          "bash",
          "-c",
          "cat > /home/user/Desktop/formula.txt << 'EOF'\nFIND(A1,\"老赵，老钱，老孙，老李\")>FIND(A2,\"老赵，老钱，老孙，老李\")\nEOF"
        ]
      }
    },
    {
      "type": "download",
      "parameters": {
        "files": [
          {
            "url": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/vibe_data_visualization/883.xlsx",
            "path": "/home/user/find_compare_conditional_formatting.xlsx"
          }
        ]
      }
    },
    {
      "type": "open",
      "parameters": {
        "path": "/home/user/find_compare_conditional_formatting.xlsx"
      }
    }
  ],
  "trajectory": "trajectories/9e39047e-c3ad-4678-aefc-2672ae33b8fb",
  "related_apps": [
    "libreoffice_calc"
  ],
  "evaluator": {
    "postconfig": [
      {
        "type": "activate_window",
        "parameters": {
          "window_name": "find_compare_conditional_formatting.xlsx - LibreOffice Calc",
          "strict": false
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      },
      {
        "type": "execute",
        "parameters": {
          "command": [
            "python",
            "-c",
            "import pyautogui; pyautogui.hotkey('ctrl', 's');"
          ]
        }
      },
      {
        "type": "sleep",
        "parameters": {
          "seconds": 0.5
        }
      }
    ],
    "func": "verify_find_compare_conditional_formatting",
    "result": {
      "type": "vm_file",
      "path": "/home/user/find_compare_conditional_formatting.xlsx",
      "dest": "find_compare_conditional_formatting.xlsx"
    },
    "options": {
      "check_range": "A2:B2",
      "formula_pattern": "FIND(A1,\"老赵，老钱，老孙，老李\")>FIND",
      "font_color": "red",
      "reference_string": "老赵，老钱，老孙，老李",
      "base_cell": "A1"
    },
    "expected": {
      "type": "cloud_file",
      "path": "https://huggingface.co/datasets/LJ-HX/vibe_working_data/resolve/main/cache/9e39047e-c3ad-4678-aefc-2672ae33b8fb/find_compare_conditional_formatting.xlsx",
      "dest": "find_compare_conditional_formatting.xlsx"
    }
  },
  "proxy": false,
  "fixed_ip": false,
  "possibility_of_env_change": "low"
}